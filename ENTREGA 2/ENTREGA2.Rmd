---
output: 
 pdf_document:
         toc: true
title: "Índice"


---

\newpage
# 1. Introducción
El objetivo de este trabajo es crear un Estadístico para estimar la media poblacional de una distribución continua determinada (que no sea la Distribución Normal ni la Exponencial) y comparar su rendimiento con la media muestral (que es el estadístico más usado para aproximar la media poblacional). En nuestro caso hemos optado por la distribución Beta (con alpha y beta = 2) debido a que su función de densidad es simétrica y centrada, y nos parece que es sencillo encontrar un Estadístico fiable para aproximar su media poblacional. 


# 2. Distribución Beta
La Distribución Beta es una distribución continua que depende de dos parámetros (alpha y beta) y que toma valores en el intervalo [0,1]. Debido a que solo está definida en [0,1] es una distribución muy usada para modelizar la probabilidad de que ocurra un evento, aunque también es usada para describir datos empíricos (debido a la variedad de formas que puede adoptar en función de los valores que tomen sus parámetros) y para modelar la fiabilidad de un sistema. Su función de densidad es distinta de cero solo cuando 0 < x < 1 y es la siguiente:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "200px", fig.align = "center"}
library(knitr)
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/DENSIDAD1.jpg")
```

También se puede escribir como:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "175px", fig.align = "center"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/funciondensidad2.jpg")
```

Dónde la función Beta es la siguiente:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "263px", fig.align = "center"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/funcionbeta.jpg")
```

\newpage
### Propiedades de la función Beta
La función beta cumple las siguientes propiedades (las usaremos para encontrar su función generadora de momentos, etc):
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "400px", fig.align = "center"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/propiedadesfuncionbeta.jpg")
```


## 2.0 Forma de la distribución Beta
Esta distribución adopta formas muy diversas, en función de los valores de sus parámetros, por ello se utiliza mucho para modelar datos de manera empírica (es decir, observando la forma de la distribución de los datos, se intenta aproximar por la distribución beta con la forma más parecida).
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "400px", fig.align = "center"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/Beta_distribution.png")
```

\newpage
## 2.1 Momentos y Función Generadora de Momentos
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "200px", fig.align = "center"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/momentos.jpg")
```
^[Nota: Los cálculos para encontrar los momentos y la función generadora están en el Anexo I y II (respectivamente)]

\newpage
# 3. Creación del Estadístico para estimar la Media Poblacional
## 3.1 Escogiendo los parámetros de la distribución
En nuestro caso hemos optado por seleccionar una distribución beta con alpha = 2, beta = 2, ya que pensamos que debido a su forma simétrica, seremos capaces de aproximar la media poblacional de manera más precisa que si fuera asimétrica. La forma de una distribución Beta(2,2) es la siguiente:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "300px", fig.align = "center"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/distribucionbetapreguntar.png")
```

Los momentos de la distribución Beta(alpha = 2, beta = 2) son los siguientes:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "150px", fig.align = "center"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/momentos22.jpg")
```

## 3.2 Fórmula del Estadístico
Nuestro estadístico es el promedio de los percentiles 40 y 60. Hemos escogido este estadístico debido a que la distribución por la que hemos optado (distribución beta(2,2)), es bastante simétrica, y nos parece que podemos llegar a estimar la media poblacional con bastante precisión. La fórmula de nuestro Estadístico es:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "200px", out.height = "100px", fig.align = "center"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/ESTADISTICO.jpg")
```


\newpage
# 4. Propiedades del Estimador T
En nuestro caso hemos podido demostrar analíticamente la insesgabilidad, la invarianza y la suficiencia de nuestro estimador.
## 4.1 Insesgabilidad
### 4.1.1. Analíticamente

### 4.1.2 Numéricamente
Para evaluar numéricamente la insesgadez hemos generado 40 muestras de distintos tamaños (n = 10, ... , n = 1000000), entonces hemos calculado nuuestro estadístico y su media (para todos los valores de n). Hemos obtenido el siguiente gráfico.
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}
library(tidyverse)
library(e1071)
library(moments)
library(gt)
library(ggpubr)
library(ggplotify)
library(grid)

# 1. Creamos las muestras, evaluamos el estadístico en ellas, así como la media muestral

entrega_dos <- function(alpha, beta){
        lista <- list()
        media_poblacional <- alpha / (alpha + beta)
        varianza_poblacional <- alpha * beta / (((alpha + beta) ^ 2 ) * (alpha + beta + 1))
        tamaño_muestral <- c(10, 100, 1000, 10000, 100000)
        lista[[6]] <- matrix(ncol = 40, nrow = length(tamaño_muestral)) 
        datos_mediamuestral <- matrix(ncol = 40, nrow = length(tamaño_muestral))
        
        for(i in seq_along(tamaño_muestral)){
                lista[[i]] <- matrix(ncol = 40, nrow = tamaño_muestral[i]) 
                for(j in 1:40){
                        set.seed(j)
                        lista[[i]][, j] <- rbeta(tamaño_muestral[i], shape1 = alpha, shape2 = beta)
                        colnames(lista[[i]])[j] <- as.numeric(gsub("V", "", colnames(lista[[i]])[j]))
                        colnames(lista[[i]])[j] <-  as.numeric(gsub("V", "", colnames(lista[[i]])[j]))
                        lista[[6]][i, j] <- 0.5*(quantile(lista[[i]][, j], probs = c(0.6)) + 
                                                        quantile(lista[[i]][, j], probs = c(0.4))) 
                        datos_mediamuestral[i, j] <- mean(lista[[i]][, j])
                }
        }
        
        
        rownames(lista[[6]]) <- tamaño_muestral

        
        # Esperanza estadístico
        lista[[6]] <- t(lista[[6]])
        lista[[7]] <- t(colMeans(lista[[6]])) %>% unname() %>% as.numeric()
        lista[[7]] <- data.frame(tamaño_muestral = as.character(tamaño_muestral), media_estadistico = lista[[7]])
        
        # Varianza estadístico
        lista[[8]] <- data.frame(tamaño_muestral = as.character(tamaño_muestral), varianza_estadistico = as.numeric(unname(apply(lista[[6]], 2, var))))
        lista[[7]] <- merge(lista[[7]], lista[[8]])
        lista[[8]] <- NULL
        
        # Sesgo, precisión, ECM, consistencia (implicita, ya que hemos calculado la varianza y el sesgo)
        for(i in 1:nrow(lista[[7]])){
                lista[[7]][i, 4] <- lista[[7]][i, 2] - media_poblacional
                lista[[7]][i, 5] <- 1/(lista[[7]][i, 3]) # precision = 1/var(t)
                lista[[7]][i, 6] <- lista[[7]][i, 3] + (lista[[7]][i, 4])^2 # ecm(t) = varianza(t) + (sesgo(t))^2
        }
        colnames(lista[[7]]) <- c("tamaño_muestral", "esperanza_estadistico", 
                                  "varianza_estadistico", "sesgo_estadistico", 
                                  "precisión_estadistico", "ECM_estadistico")
        
        rownames(datos_mediamuestral) <- rownames(lista[[6]])
        datos_mediamuestral <- t(datos_mediamuestral)
        datos_mediamuestral <- data.frame(tamaño_muestral = as.character(tamaño_muestral),
                                              esperanza_mediamuestral = as.numeric(unname(apply(datos_mediamuestral, 2, mean))),
                                              varianza_mediamuestral = as.numeric(unname(apply(datos_mediamuestral, 2, var))),
                                              sesgo_mediamuestral = as.numeric(unname(apply(datos_mediamuestral, 2, mean))) - media_poblacional, 
                                              precision_mediamuestral = 1/as.numeric(unname(apply(datos_mediamuestral, 2, var))))
        datos_mediamuestral$ECM_mediamuestral <- datos_mediamuestral$varianza_mediamuestral + (datos_mediamuestral$sesgo_mediamuestral)^2
        colnames(datos_mediamuestral) <- c("tamaño_muestral", "esperanza_mediamuestral", 
                                               "varianza_mediamuestral", "sesgo_mediamuestral", 
                                               "precisión_mediamuestral", "ECM_mediamuestral")
        
        # Falta invarianza y suficiencia
        
        # Robustez
        distribucion_muestral_beta <- as.data.frame(matrix(nrow = 10, ncol = 40))
        distribucion_muestral_uniforme <- as.data.frame(matrix(nrow = 10, ncol = 40))
        distribucion_muestral_contaminada <- as.data.frame(matrix(nrow = 10, ncol = 40))
        estadistico <- as.data.frame(matrix(nrow = 1, ncol = 40))
        media_muestral <- as.data.frame(matrix(nrow = 1, ncol = 40))
        porcentaje_contaminacion <- 0.9
        unif_prob_contaminar <- matrix(runif(400, min = 0, max = 1), byrow = TRUE, ncol = 40, nrow = 10) %>% as.data.frame()
        
        for(j in 1:40){
                distribucion_muestral_beta[, j] <- rbeta(10, shape1 = alpha, shape2 = beta)
                distribucion_muestral_uniforme[, j] <- runif(10, min = 2, max = 3)
                for(i in 1:10){
                        if(unif_prob_contaminar[i, j] <= 0.9){
                                distribucion_muestral_contaminada[i, j] <- distribucion_muestral_beta[i, j]
                        } else if(unif_prob_contaminar[i, j] > 0.9) {
                                distribucion_muestral_contaminada[i, j] <- distribucion_muestral_uniforme[i, j]
                        }
                }
        }
        for(j in 1:40){
                estadistico[, j] <- 0.5*(quantile(distribucion_muestral_contaminada[, j], probs = c(0.6)) + 
                                                 quantile(distribucion_muestral_contaminada[, j], probs = c(0.4)))
        }
        colnames(distribucion_muestral_beta) <-  as.numeric(gsub("V", "", colnames(distribucion_muestral_beta)))
        colnames(distribucion_muestral_uniforme) <-  as.numeric(gsub("V", "", colnames(distribucion_muestral_uniforme)))
        colnames(distribucion_muestral_contaminada) <-  as.numeric(gsub("V", "", colnames(distribucion_muestral_contaminada)))
        media_muestral <- data.frame(Muestra = names(colMeans(distribucion_muestral_contaminada)), 
                                     mediamuestral = unname(colMeans(distribucion_muestral_contaminada))) 
        media_muestral$Muestra <- as.numeric(media_muestral$Muestra)
        lista[[8]] <- distribucion_muestral_contaminada
        lista[[9]] <- gather(as.data.frame(estadistico))
        lista[[9]][, 1] <- 1:nrow(lista[[9]])
        colnames(lista[[9]]) <- c("Muestra", "Estadistico")
        
        
        lista[[10]] <- data.frame(Estimador = "Estadístico",
                                  Media = mean(lista[[9]][, 2]),
                                  Mediana = median(lista[[9]][, 2]),
                                  SD = sd(lista[[9]][, 2]), 
                                  IQR = IQR(lista[[9]][, 2]), 
                                  MAD = mad(lista[[9]][, 2]), 
                                  Curtosis = moments::kurtosis(lista[[9]][, 2]), 
                                  Asimetría = e1071::skewness(lista[[9]][, 2]))
        
        lista[[11]] <- media_muestral
        
        lista[[12]] <- data.frame(Estimador = "Media Muestral", 
                                  Media = mean(lista[[11]][, 2]),
                                  Mediana = median(lista[[11]][, 2]),
                                  SD = sd(lista[[11]][, 2]), 
                                  IQR = IQR(lista[[11]][, 2]), 
                                  MAD = mad(lista[[11]][, 2]), 
                                  Curtosis = moments::kurtosis(lista[[11]][, 2]), 
                                  Asimetría = e1071::skewness(lista[[11]][, 2]))
        
        
        lista[[13]] <- rbind(lista[[10]], lista[[12]])
        lista[[14]] <- media_poblacional
        lista[[15]] <- varianza_poblacional
        lista[[16]] <- datos_mediamuestral
        names(lista) <- c("muestras_10", "muestras_100", 
                          "muestras_1000", "muestras_10000", 
                          "muestras_100k", "estadístico_n", 
                          "propiedades_estimador", "distribucion_contaminada", 
                          "estadistico", "medidas_estadistico", 
                          "media_muestral", "medidas_media_muestral", 
                          "tabla_comparacion", "media_poblacional", "varianza_poblacional",
                          "datos_mediamuestral")
        

        lista
}

resultados <- entrega_dos(alpha = 2, beta = 2)

# Insesgadez 
datos_graficos <- resultados$propiedades_estimador
colores_esperanza <- c("E[T]" = "black", "Media Poblacional" = "red")
# Hemos visto analíticamente que nuestro estimador es insesgado, es decir, que en promedio es la media poblacional
# Aquí podemos ver que a medida que aumenta el tamaño muestral (n), la esperanza de nuestro estadístico se va acercando cada vez más a la media poblacional
# De aquí podemos suponer que para un n suficientemente grande, la esperanza del estadístico convergerá a la media poblacional
grafico_esperanza <- ggplot(data = datos_graficos, aes(x = tamaño_muestral, y = esperanza_estadistico, 
                                  group = 1)) + 
        geom_line(aes(color = "E[T]"), size = 0.5) + geom_point(size = 3) + 
        geom_hline(aes(yintercept = resultados$media_poblacional, color = "Media Poblacional"), 
                   linetype = "dashed", size = 1) + 
        scale_color_manual(values = colores_esperanza) + 
        ggtitle("Esperanza de nuestro estadístico T") + 
        xlab("Tamaño Muestral (n)") + ylab("E[T]") +
        theme(legend.position = "top",
              legend.title = element_blank(),
              legend.text = element_text(size = 14),
              axis.text.x = element_text(size = 12),
              axis.text.y = element_text(size = 12),
              axis.title = element_text(size = 13, face = "bold"), 
              plot.title = element_text(size = 18, face = 'bold', hjust = 0.5)) 

# En otras palabras, el sesgo de nuestro estimador tiende a cero cuando n tiende a infinito.
colores_sesgo <- c("b[T]" = "black", "0" = "red")
grafico_sesgo <- ggplot(data = datos_graficos, 
                        aes(x = tamaño_muestral, 
                            y = sesgo_estadistico, 
                                                       group = 1)) + 
        geom_line(aes(color = "b[T]"), size = 0.5) + 
        geom_point(size = 3) + 
        geom_hline(aes(yintercept = 0, color = "0"), 
                   linetype = "dashed", size = 1) +
        scale_color_manual(values = colores_sesgo) + 
        ggtitle("Sesgo del estadístico T") + 
        xlab("Tamaño Muestral (n)") + ylab("b[T]") +
        theme(legend.position = "none",
              legend.title = element_blank(),
              legend.text = element_text(size = 14),
              axis.text.x = element_text(size = 12),
              axis.text.y = element_text(size = 12),
              axis.title = element_text(size = 13, 
                                        face = "bold"), 
              plot.title = element_text(size = 18, 
                                        face = 'bold', 
                                        hjust = 0.5)) 
grafico_esperanza
```
Podemos ver que a medida que aumenta el tamaño muestral (n), la esperanza de nuestro estadístico se va acercando cada vez más a la media poblacional. De aquí podemos suponer que para un n suficientemente grande, la esperanza del estadístico convergerá a la media poblacional.

\newpage
Definimos el sesgo como:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "170px", fig.align = "center", out.height = "200px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/FORMULAS/sesgo.jpg")
```
Hemos obtenido el siguiente gráfico para el sesgo.
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}

grafico_sesgo
```
En este caso, podemos observar que el sesgo de nuestro estimador tiende a cero, a medida que aumenta el tamaño muestral. 
Después de la demostración analítica y de observar los dos gráficos anteriores, podemos concluir que nuestro estimador es **insesgado**.

\newpage
## 4.2 Eficiencia / Precisión
La eficiencia o precisión se define como: 
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "200px", fig.align = "center", out.height = "250px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/FORMULAS/precision.jpg")
```

En nuestro caso hemos generado 40 muestras de distintos tamaños (n = 10, ... , n = 1000000), y hemos calculado la varianza y la precisión de nuestro estadístico para cada uno de los tamaños muestrales. Además hemos decidido comparar la eficiencia de nuestro estimador T y la media muestral.
Hemos obtenido el siguiente gráfico para el sesgo.
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}
datos_comparar_precision <- cbind(datos_graficos, resultados$datos_mediamuestral)[, c(1,3,5,9,11)]
colores_precision <- c("Pr[T]" = "black", "Pr[Media Muestral]" = "red")
grafico_comparacion_precision <- ggplot(data = datos_comparar_precision, aes(x = tamaño_muestral, group = 1)) + 
        geom_line(aes(y = precisión_estadistico, color = "Pr[T]"), size = 0.75) + 
        geom_point(aes(y = precisión_estadistico, color = "Pr[T]"), size = 1.5) + 
        geom_line(aes(y = precisión_mediamuestral, color = "Pr[Media Muestral]"), size = 0.75) +
        geom_point(aes(y = precisión_mediamuestral, color = "Pr[Media Muestral]"), size = 1.5) + 
        scale_color_manual(values = colores_precision) +
        ggtitle("Precisión: T vs Media Muestral") + 
        xlab("Tamaño Muestral (n)") + ylab("Precisión") +
        theme(legend.position = "top",
              legend.title = element_blank(),
              legend.text = element_text(size = 14),
              axis.text.x = element_text(size = 12),
              axis.text.y = element_text(size = 12),
              axis.title = element_text(size = 13, face = "bold"), 
              plot.title = element_text(size = 18, face = 'bold', 
                                        hjust = 0.5)) 
grafico_comparacion_precision
```
Podemos observar que la media muestral es más precisa estimando la media poblacional que nuestro parámetro. Esto se debe a que la varianza de la media muestral es menor que la de nuestro estadístico, y también a que la media muestral es el estimador máximo verosímil de la media poblacional.

\newpage
## 4.3 Error cuadrático Medio (ECM)
El error cuadrático medio de un estimador T se define como el promedio de las desviaciones del estadístico al parámetro que estima. Matemáticamente: 
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "350px", fig.align = "center", out.height = "300px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/FORMULAS/ECM.jpg")
```

En este caso hemos seguido el mismo procedimiento que en las anteriores propiedades, obteniendo el siguiente gráfico:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}
datos_comparar_ecm <- cbind(datos_graficos, resultados$datos_mediamuestral)[, c(1, 6, 12)]
colores_ecm <- c("ECM[T]" = "black", "ECM[Media Muestral]" = "red")
grafico_comparacion_ECM <- ggplot(data = datos_comparar_ecm, aes(x = tamaño_muestral, group = 1)) + 
        geom_line(aes(y = ECM_estadistico, color = "ECM[T]"), size = 0.75) + 
        geom_point(aes(y = ECM_estadistico, color = "ECM[T]"), size = 1.5) + 
        geom_line(aes(y = ECM_mediamuestral, color = "ECM[Media Muestral]"), size = 0.75) +
        geom_point(aes(y = ECM_mediamuestral, color = "ECM[Media Muestral]"), size = 1.5) + 
        scale_color_manual(values = colores_ecm) +
        ggtitle("ECM: T vs Media Muestral") + 
        xlab("Tamaño Muestral (n)") + ylab("Precisión") +
        theme(legend.position = "top",
              legend.title = element_blank(),
              legend.text = element_text(size = 14),
              axis.text.x = element_text(size = 12),
              axis.text.y = element_text(size = 12),
              axis.title = element_text(size = 13, face = "bold"), 
              plot.title = element_text(size = 18, face = 'bold', 
                                        hjust = 0.5)) 
grafico_comparacion_ECM
```

Como ambos estimadores (la media muestral y T), son insesgados, el ECM de ambos se reduce a su varianza, y como la media muestral tiene menos varianza, tamién tiene menor error cuadrático medio.

\newpage
## 4.4 Consistencia
Un estimador T se dice consistente si como condición suficiente cumple las siguientes propiedades:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "250px", fig.align = "center", out.height = "200px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/FORMULAS/consistencia.jpg")
```

En nuestro caso hemos tenido que probar la consistencia numéricamente, puesto que el cálculo de la varianza de manera analítica es muy complicada. Hemos obtenido los siguientes gráficos:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "350px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/PLOTS/consistencia.png")
```
Podemos observar como al aumentar el tamaño muestral (es decir cuando n tiende a infinito), tanto la varianza de nuestro estadístico y el sesgo tienden a cero. Esto nos permite afirmar con bastante seguridad que nuestro estimador es **consistente** para la media poblacional, es decir, que al aumentar el tamaño muestral se aproxima bien a ella.

\newpage
## 4.5 Invarianza
Se dice que un estimador T es invariante por traslaciones (1) o por cambios de escala (2), si se cumple que:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/FORMULAS/invarianza.jpg")
```

En nuestro caso, sabemos que los percentiles son **invariantes por traslaciones** ya que al sumar a cada elemento de la muestra una constante el percentil k-ésimo sigue siendo el mismo, y **lo mismo en el caso de los cambios de escala**. No es posible demostrar esto analíticamente, debido a que no disponemos de una expresión escrita del percentil.

\newpage
## 4.6 Robustez 
Para analizar la robustez hemos generado una distribución contaminada, a partir de nuestra distribución original (Beta(2,2)) y la distribución Uniforme en el intervalo [2, 3]. Para crear la muestra contaminada hemos generado 400 datos aleatorios de una distribución Uniforme[0,1]. En caso de que la probabilidad de esta última distribución fuera menor o igual que 0.9, generabamos un dato de la Beta[2,2], y en caso que p > 0.9 escogíamos un dato de la Uniforme[2,3]. 

Gráficamente:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "250px", fig.align = "center", out.height = "200px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/FORMULAS/robustez3.png")
```

\newpage
### 4.6.1 Robustez de nuestro estadístico
\newpage
#### 4.6.1.1 Muestra sin contaminar
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/MEDIDAS/medidasestadistico2.png")
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/PLOTS/hist_est_sincontaminar.png")
```

\newpage
#### 4.6.1.2 Muestra contaminada
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/PLOTS/tabla_estadistico.png")
datosgrafico <- inner_join(resultados$media_muestral , resultados$estadistico)
# 2. 2. Gráficos sobre nuestro estimador: analizar y calcular otras medidas (de centralización y dispersión), hacer boxplots, hacer gráficos de los residuos, etc
tabla_medidas_estadistico <- gt(resultados$medidas_estadistico[-1]) %>% 
        tab_header(title = md("**Estadístico T**")) %>% 
        tab_spanner(label = md("***Medidas de Centralización***"), columns = c(1, 2)) %>% 
        tab_spanner(label = md("***Medidas de Dispersión***"), columns = c(3:5)) %>% 
        tab_spanner(label = md("***Medidas de Forma***"), columns = c(6, 7))

## 2.1 Histogramas

grafico_estadistico_histogram_density <- ggplot(data = datosgrafico, aes(x = Estadistico)) + 
        geom_histogram(aes(y = ..ndensity..), fill = "lightblue", binwidth = 0.05, color = "black", position = "identity") + 
        geom_density(aes(x = Estadistico, y = ..ndensity..), color = "blue", size = 0.75) +
        ggtitle("Histograma de nuestro Estadístico T") + 
        geom_vline(aes(xintercept = resultados$medidas_estadistico$Media, col = "Estimador"), linetype = "dashed", size = 1) +
        geom_vline(aes(xintercept = resultados$media_poblacional,  col = "Media Poblacional"), size = 1) + 
        scale_color_manual(name = "", values = c("Media Poblacional" = "black", Estimador = "red")) + 
        xlab("x") + ylab("f(x)") +
        theme(legend.position = "top",
              legend.text = element_text(size = 14),
              axis.text.x = element_text(size = 12),
              axis.text.y = element_text(size = 12),
              axis.title = element_text(size = 13, face = "bold"), 
              plot.title = element_text(size = 18, face = 'bold', hjust = 0.5)) + xlim(0, 1)
grafico_estadistico_histogram_density
```

\newpage
### 4.6.2 Robustez de la Media Muestral
#### 4.6.2.1 Muestra sin contaminar
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 1/IMAGENES/MEDIDAS/medidasmediamuestral.png")
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/PLOTS/hist_mediamuestral_sincontaminar.png")

```


\newpage
#### 4.6.2.2 Muestra contaminada
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "450px", fig.align = "center", out.height = "400px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/PLOTS/tabla_mediamuestral.png")
datosgrafico <- inner_join(resultados$media_muestral , resultados$estadistico)
grafico_mediamuestral_histogram_density <- ggplot(data = datosgrafico, aes(x = mediamuestral)) + 
        geom_histogram(aes(y = ..ndensity..), fill = "lightblue", color = "black", binwidth = 0.05) + 
        geom_density(aes(y = ..ndensity..), size = 0.75, col = "blue") +
        ggtitle("Histograma de la Media Muestral") + 
        geom_vline(aes(xintercept = resultados$medidas_media_muestral$Media, col = "Media Muestral"), linetype = "dashed", size = 1) +
        geom_vline(aes(xintercept = resultados$media_poblacional,  col = "Media Poblacional"), size = 1) + 
        scale_color_manual(name = "", values = c("Media Poblacional" = "black", "Media Muestral" = "red")) + 
        xlab("x") + ylab("f(x)") +
        theme(legend.position = "top",
              legend.text = element_text(size = 14),
              axis.text.x = element_text(size = 12),
              axis.text.y = element_text(size = 12),
              axis.title = element_text(size = 13, face = "bold"), 
              plot.title = element_text(size = 18, face = 'bold', hjust = 0.5)) + xlim(0, 1)
grafico_mediamuestral_histogram_density
```

\newpage
### 4.6.3 Varianza de la media muestral
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = FALSE, out.width = "250px", fig.align = "center", out.height = "200px"}
knitr::include_graphics("C:/Users/marct/Documents/UNI_ESTADISTICA/2o/PRIMER CUATRIMESTRE/INFERENCIA ESTADISTICA I/TRABAJOS/INFERENCIA/ENTREGA 2/IMAGENES/PLOTS/varianza_mediamuestral.png")
```

\newpage



\newpage
## 4.7 Suficiencia

